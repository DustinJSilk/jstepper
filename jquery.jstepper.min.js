// jStepper 1.5.0
(function(e){e.fn.jStepper=function(t,n,r){if(this.length>1){this.each(function(){$(this).jStepper(t)});return this}if(typeof t==="string"){if(t==="option"){if(r===null){r=e.fn.jStepper.defaults[n]}this.data("jstepper.o")[n]=r}return this}var i=e.extend({},e.fn.jStepper.defaults,t);if(e.metadata){i=e.extend({},i,this.metadata())}this.data("jstepper.o",i);if(i.disableAutocomplete){this.attr("autocomplete","off")}if(e.isFunction(this.mousewheel)){this.mousewheel(function(t,n){if(i.disableMouseWheel){return}if(n>0){var r=e.Event("keydown");r.keyCode=38;o(1,r,this);return false}else if(n<0){var r=e.Event("keydown");r.keyCode=40;o(0,r,this);return false}})}this.blur(function(){s(this,null)});this.keydown(function(e){var t=e.keyCode;if(t===38){o(1,e,this)}else if(t===40){o(0,e,this)}else{if(i.overflowMode==="ignore"){if(i.maxValue){if($(this).val().length>=i.maxValue.toString().length){if((t>=48&&t<=57||t>=96&&t<=105)&&this.selectionStart===this.selectionEnd){return false}}}}}});this.keyup(function(e){s(this,e)});var s=function(t,n){var r=e(t);var s=r.val();var o=s;if(i.disableNonNumeric){s=s.replace(/[^\d\.,\-]/gi,"")}var a=false;if(i.maxValue!==null){if(s>i.maxValue){s=i.maxValue;a=true}}if(i.minValue!==null){if(s<i.minValue&&s!=""){s=i.minValue;a=true}}if(h(n)===true||n===null||a===true){s=u(s)}if(o!=s){r.val(s)}};var o=function(t,n,r){var o=e(r);var u;if(n){if(n.ctrlKey){u=i.ctrlStep}else if(n.shiftKey){u=i.shiftStep}else{u=i.normalStep}}else{u=i.normalStep}var a=o.val();var f=a.length-r.selectionStart;var l=a.length-r.selectionEnd;a=a.replace(/,/g,".");a=a.replace(i.decimalSeparator,".");a=a+"";if(a.indexOf(".")!=-1){a=a.match(new RegExp("-{0,1}[0-9]+[\\.][0-9]*"))}a=a+"";if(a.indexOf("-")!=-1){a=a.match(new RegExp("-{0,1}[0-9]+[\\.]*[0-9]*"))}a=a+"";a=a.match(new RegExp("-{0,1}[0-9]+[\\.]*[0-9]*"));if(a===""||a=="-"||a===null){a=i.defaultValue}if(t===1){a=e.fn.jStepper.AddOrSubtractTwoFloats(a,u,true)}else{a=e.fn.jStepper.AddOrSubtractTwoFloats(a,u,false)}var c=false;if(i.maxValue!==null){if(a>=i.maxValue){a=i.maxValue;c=true}}if(i.minValue!==null){if(a<=i.minValue){a=i.minValue;c=true}}a=a.toString().replace(/\./,i.decimalSeparator);o.val(a);r.selectionStart=a.length-f;r.selectionEnd=a.length-l;s(r,n);if(i.onStep){i.onStep(o,t,c)}return false};var u=function(e){var t=e.toString();t=a(t);t=f(t);t=l(t);t=c(t);return t};var a=function(e){var t=e;if(i.minDecimals>0){var n;if(t.indexOf(".")!=-1){var r=t.length-(t.indexOf(".")+1);if(r<i.minDecimals){n=i.minDecimals-r}}else{n=i.minDecimals;t=t+"."}for(var s=1;s<=n;s++){t=t+"0"}}return t};var f=function(e){var t=e;if(i.maxDecimals>0){var n=0;if(t.indexOf(".")!=-1){n=t.length-(t.indexOf(".")+1);if(i.maxDecimals<n){t=t.substring(0,t.indexOf("."))+"."+t.substring(t.indexOf(".")+1,t.indexOf(".")+1+i.maxDecimals)}}}return t};var l=function(e){var t=e;if(!i.allowDecimals){t=t.toString().replace(i.decimalSeparator,".");t=t.replace(new RegExp("[\\.].+"),"")}return t};var c=function(e){var t=e;if(i.minLength!==null){var n=t.length;if(t.indexOf(".")!=-1){n=t.indexOf(".")}var r=false;if(t.indexOf("-")!=-1){r=true;t=t.replace(/-/,"")}if(n<i.minLength){for(var s=1;s<=i.minLength-n;s++){t="0"+t}}if(r){t="-"+t}}return t};var h=function(e){var t=false;if(e!==null){if(e.keyCode===38||e.keyCode===40){t=true}}return t};var p=function(e){return this.data("jstepper.o")[e]};return this};e.fn.jStepper.AddOrSubtractTwoFloats=function(e,t,n){var r=e.toString();var i=t.toString();var s="";if(r.indexOf(".")>-1||i.indexOf(".")>-1){if(r.indexOf(".")===-1){r=r+".0"}if(i.indexOf(".")===-1){i=i+".0"}var o=r.substr(r.indexOf(".")+1);var u=i.substr(i.indexOf(".")+1);var a=r.substr(0,r.indexOf("."));var f=i.substr(0,i.indexOf("."));var l=true;while(l){if(o.length!==u.length){if(o.length<u.length){o+="0"}else{u+="0"}}else{l=false}}var c=o.length;for(var h=0;h<=o.length-1;h++){a=a+o.substr(h,1);f=f+u.substr(h,1)}var p=Number(a);var d=Number(f);var v;if(n){v=p+d}else{v=p-d}var m=false;if(v<0){m=true;v=Math.abs(v)}s=v.toString();for(var g=0;g<c-s.length+1;g++){s="0"+s}if(s.length>=c){s=s.substring(0,s.length-c)+"."+s.substring(s.length-c)}if(m===true){s="-"+s}}else{if(n){s=Number(e)+Number(t)}else{s=Number(e)-Number(t)}}return Number(s)};e.fn.jStepper.defaults={maxValue:null,minValue:null,normalStep:1,shiftStep:5,ctrlStep:10,minLength:null,disableAutocomplete:true,defaultValue:1,decimalSeparator:",",allowDecimals:true,minDecimals:0,maxDecimals:null,disableNonNumeric:true,onStep:null,overflowMode:"default",disableMouseWheel:false}})(jQuery)